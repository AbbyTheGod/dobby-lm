// Mock Fireworks API for testing when API key is not available

const mockResponses = {
  chat: [
    "Hello! I'm Dobby, your AI assistant. I'm here to help you with questions based on your sources. How can I assist you today?",
    "Based on the sources provided, I can help you understand the content. What specific information are you looking for?",
    "I'd be happy to help! Let me search through your sources to find the most relevant information for your question."
  ],
  summary: `# Executive Summary

Based on the provided sources, here are the key findings:

## Key Points
- **Artificial Intelligence**: A branch of computer science focused on creating intelligent machines
- **Machine Learning**: A subset of AI that enables computers to learn from experience
- **Applications**: AI systems can learn, reason, and make decisions similar to humans

## Recommendations
1. Focus on understanding the fundamentals of AI
2. Explore machine learning applications
3. Consider practical implementations

*Generated by Dobby AI Assistant*`,
  
  flashcards: [
    {
      front: "What is Artificial Intelligence?",
      back: "A branch of computer science that aims to create machines capable of intelligent behavior"
    },
    {
      front: "What is Machine Learning?",
      back: "A subset of AI that enables computers to learn and improve from experience without being explicitly programmed"
    },
    {
      front: "What can AI systems do?",
      back: "Learn, reason, and make decisions similar to humans"
    }
  ],
  
  quiz: {
    questions: [
      {
        type: "multiple_choice",
        question: "What is the main goal of Artificial Intelligence?",
        options: [
          "To replace human workers",
          "To create machines capable of intelligent behavior", 
          "To make computers faster",
          "To reduce energy consumption"
        ],
        correct_answer: 1,
        explanation: "AI aims to create machines that can exhibit intelligent behavior similar to humans."
      },
      {
        type: "short_answer",
        question: "What is Machine Learning?",
        correct_answer: "A subset of AI that enables computers to learn from experience",
        explanation: "Machine Learning allows computers to improve their performance on a task through experience."
      }
    ]
  }
};

async function mockFireworksCall(messages, options = {}) {
  // Simulate API delay
  await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
  
  const lastMessage = messages[messages.length - 1];
  const content = lastMessage.content.toLowerCase();
  
  // Determine response type based on content
  if (content.includes('flashcard') || content.includes('flash card')) {
    return {
      choices: [{
        message: {
          content: JSON.stringify(mockResponses.flashcards)
        }
      }]
    };
  }
  
  if (content.includes('quiz') || content.includes('question')) {
    return {
      choices: [{
        message: {
          content: JSON.stringify(mockResponses.quiz)
        }
      }]
    };
  }
  
  if (content.includes('summary') || content.includes('briefing')) {
    return {
      choices: [{
        message: {
          content: mockResponses.summary
        }
      }]
    };
  }
  
  // Default chat response
  const randomResponse = mockResponses.chat[Math.floor(Math.random() * mockResponses.chat.length)];
  return {
    choices: [{
      message: {
        content: randomResponse
      }
    }]
  };
}

export {
  createChatCompletion: mockFireworksCall
};
